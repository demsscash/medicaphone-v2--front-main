<!-- src/app/features/home/home.component.html -->
<div class="home-container">
  <!-- Header -->
  <header class="header">
    <div class="logo-container">
      <div class="logo-icon">
        <svg width="147" height="46" viewBox="0 0 147 46" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0_393_774)">
            <path
              d="M47.6845 20.9515C46.2776 20.9515 44.9569 20.7219 43.7511 20.234C42.5452 19.7749 41.4829 19.1149 40.5929 18.254C39.7028 17.3931 39.0138 16.3887 38.497 15.2122C38.0089 14.0356 37.7505 12.773 37.7505 11.3955C37.7505 10.0181 38.0089 8.75545 38.497 7.5789C38.9851 6.40234 39.7028 5.39796 40.5929 4.53707C41.4829 3.67617 42.5452 3.01616 43.7511 2.55701C44.9569 2.09787 46.2776 1.8396 47.7132 1.8396C49.2349 1.8396 50.613 2.09787 51.8763 2.6144C53.1396 3.13094 54.2019 3.90575 55.0632 4.93882L52.8237 7.03366C52.1634 6.31625 51.3882 5.77102 50.5556 5.39796C49.7229 5.02491 48.8329 4.85273 47.8567 4.85273C46.8806 4.85273 45.9905 5.02491 45.1866 5.34057C44.3827 5.65623 43.6937 6.11538 43.0907 6.68931C42.4878 7.26324 42.0284 7.95195 41.7126 8.75545C41.3968 9.55895 41.2245 10.4198 41.2245 11.3955C41.2245 12.3712 41.3968 13.2321 41.7126 14.0356C42.0284 14.8391 42.4878 15.5278 43.0907 16.1018C43.6937 16.6757 44.3827 17.1348 45.1866 17.4505C45.9905 17.7662 46.8806 17.9383 47.8567 17.9383C48.8329 17.9383 49.7229 17.7661 50.5556 17.3931C51.3882 17.02 52.1347 16.4748 52.8237 15.7287L55.0632 17.8522C54.2019 18.8566 53.1396 19.6314 51.8763 20.148C50.613 20.6645 49.2349 20.9515 47.6845 20.9515Z"
              fill="#363C3D" />
            <path
              d="M63.6761 20.8648C62.2118 20.8648 60.9198 20.5491 59.8001 19.9178C58.6804 19.2865 57.7616 18.4256 57.13 17.3351C56.4696 16.2446 56.1538 14.982 56.1538 13.6046C56.1538 12.2271 56.4696 10.9358 57.13 9.84532C57.7903 8.75485 58.6804 7.89396 59.8001 7.29133C60.9198 6.68871 62.2118 6.37305 63.6761 6.37305C65.1403 6.37305 66.461 6.68871 67.5808 7.29133C68.7292 7.92266 69.6192 8.75485 70.2509 9.84532C70.8825 10.9358 71.2271 12.1697 71.2271 13.6046C71.2271 15.0394 70.9112 16.2446 70.2509 17.3351C69.6192 18.4256 68.7005 19.2865 67.5808 19.9178C66.461 20.5491 65.1403 20.8648 63.6761 20.8648ZM63.6761 18.0238C64.48 18.0238 65.2265 17.8516 65.8581 17.4786C66.4897 17.1342 67.0065 16.6177 67.3511 15.929C67.7243 15.269 67.8966 14.4655 67.8966 13.5759C67.8966 12.6863 67.7243 11.8541 67.3511 11.1941C66.9778 10.534 66.4897 10.0175 65.8581 9.67314C65.2265 9.32878 64.5087 9.12791 63.7048 9.12791C62.9009 9.12791 62.1544 9.30009 61.5515 9.67314C60.9198 10.0175 60.4317 10.534 60.0585 11.1941C59.6853 11.8541 59.4843 12.6576 59.4843 13.5759C59.4843 14.4942 59.6853 15.269 60.0585 15.929C60.4317 16.589 60.9198 17.1055 61.5515 17.4786C62.1831 17.8229 62.9009 18.0238 63.6761 18.0238Z"
              fill="#363C3D" />
            <path
              d="M80.4147 20.8652C79.2089 20.8652 78.1466 20.6357 77.2278 20.1765C76.3091 19.7174 75.5913 19.0286 75.0745 18.1104C74.5577 17.1921 74.2993 16.0155 74.2993 14.6094V6.51698H77.6298V14.1502C77.6298 15.4129 77.9169 16.3599 78.4911 16.9912C79.0653 17.6225 79.8979 17.9382 80.9603 17.9382C81.7354 17.9382 82.4245 17.766 82.9987 17.4503C83.573 17.1347 84.0323 16.6468 84.3481 16.0155C84.6927 15.3842 84.8362 14.5807 84.8362 13.6624V6.48828H88.1667V20.6643H85.0085V16.8477L85.5827 18.0243C85.0946 18.9426 84.4056 19.66 83.4868 20.1191C82.5681 20.607 81.5632 20.8365 80.4722 20.8365L80.4147 20.8652Z"
              fill="#363C3D" />
            <path
              d="M92.4736 20.6927V6.51666H95.6318V10.4194L95.2586 9.27152C95.6893 8.32454 96.3496 7.60713 97.2684 7.09059C98.1871 6.60275 99.3068 6.34448 100.685 6.34448V9.5011C100.685 9.5011 100.398 9.4437 100.283 9.4437C100.168 9.4437 100.025 9.4437 99.9098 9.4437C98.6465 9.4437 97.6416 9.81676 96.9238 10.5342C96.1773 11.2803 95.8041 12.3707 95.8041 13.8056V20.664H92.4736V20.6927Z"
              fill="#363C3D" />
            <path
              d="M103.498 20.6927V6.51666H106.656V10.4194L106.283 9.27152C106.714 8.32454 107.374 7.60713 108.293 7.09059C109.212 6.60275 110.331 6.34448 111.709 6.34448V9.5011C111.709 9.5011 111.451 9.4437 111.307 9.4437C111.193 9.4437 111.049 9.4437 110.934 9.4437C109.671 9.4437 108.666 9.81676 107.948 10.5342C107.23 11.2516 106.829 12.3707 106.829 13.8056V20.664H103.498V20.6927Z"
              fill="#363C3D" />
            <path
              d="M116.189 4.19254C115.557 4.19254 115.069 3.99166 114.667 3.61861C114.265 3.24555 114.064 2.75771 114.064 2.21248C114.064 1.66725 114.265 1.17941 114.667 0.806352C115.069 0.433297 115.586 0.232422 116.189 0.232422C116.792 0.232422 117.309 0.404601 117.711 0.777655C118.113 1.15071 118.314 1.60985 118.314 2.15509C118.314 2.72902 118.113 3.21686 117.739 3.61861C117.337 4.02036 116.849 4.22123 116.189 4.22123V4.19254ZM114.495 20.693V6.51695H117.826V20.693H114.495Z"
              fill="#363C3D" />
            <path
              d="M128.85 20.8648C127.271 20.8648 125.893 20.5491 124.716 19.9178C123.539 19.2865 122.62 18.4256 121.988 17.3351C121.328 16.2446 121.012 14.982 121.012 13.6046C121.012 12.2271 121.328 10.9358 121.96 9.84532C122.591 8.75485 123.453 7.89396 124.572 7.29133C125.692 6.68871 126.927 6.37305 128.362 6.37305C129.798 6.37305 130.975 6.66001 132.066 7.26264C133.157 7.86526 133.99 8.69746 134.621 9.81662C135.253 10.9071 135.54 12.1984 135.54 13.6906C135.54 13.8341 135.54 14.0063 135.54 14.1785C135.54 14.3507 135.54 14.5228 135.511 14.695H123.711V12.4854H133.76L132.468 13.1741C132.468 12.3706 132.324 11.6532 131.951 11.0219C131.607 10.4193 131.118 9.93141 130.516 9.55836C129.913 9.1853 129.195 9.04182 128.42 9.04182C127.644 9.04182 126.898 9.214 126.295 9.55836C125.692 9.90271 125.204 10.3906 124.859 11.0219C124.515 11.6532 124.343 12.3993 124.343 13.2315V13.7767C124.343 14.6376 124.544 15.3837 124.917 16.0438C125.319 16.7038 125.864 17.1916 126.553 17.5647C127.271 17.909 128.075 18.0812 128.994 18.0812C129.798 18.0812 130.516 17.9664 131.147 17.7082C131.779 17.4499 132.353 17.0768 132.841 16.5316L134.621 18.569C133.99 19.3152 133.186 19.8891 132.209 20.2908C131.233 20.6926 130.142 20.8935 128.908 20.8935L128.85 20.8648Z"
              fill="#363C3D" />
            <path
              d="M138.698 20.6927V6.51666H141.856V10.4194L141.483 9.27152C141.914 8.32454 142.574 7.60713 143.493 7.09059C144.411 6.60275 145.531 6.34448 146.909 6.34448V9.5011C146.909 9.5011 146.622 9.4437 146.507 9.4437C146.393 9.4437 146.249 9.4437 146.134 9.4437C144.871 9.4437 143.866 9.81676 143.148 10.5342C142.402 11.2803 142.028 12.3707 142.028 13.8056V20.664H138.698V20.6927Z"
              fill="#363C3D" />
            <path
              d="M39.0996 44.9985V26.4319H47.2248C49.2346 26.4319 51.0146 26.8336 52.5363 27.6084C54.058 28.3832 55.2352 29.4737 56.0965 30.8511C56.9578 32.2286 57.3598 33.8643 57.3598 35.7295C57.3598 37.5948 56.9291 39.2018 56.0965 40.608C55.2352 41.9854 54.058 43.0758 52.5363 43.8507C51.0146 44.6255 49.2346 45.0272 47.2248 45.0272H39.0996V44.9985ZM42.5449 42.0715H47.0525C48.4307 42.0715 49.6365 41.8132 50.6701 41.268C51.7037 40.7514 52.4789 40.0053 53.0531 39.0296C53.5986 38.0827 53.8857 36.9635 53.8857 35.6722C53.8857 34.3808 53.5986 33.2616 53.0531 32.3147C52.5076 31.3677 51.7037 30.6216 50.6701 30.105C49.6365 29.5598 48.4307 29.3015 47.0525 29.3015H42.5449V42.0428V42.0715Z"
              fill="#363C3D" />
            <path
              d="M62.3561 28.4984C61.7244 28.4984 61.2363 28.2976 60.8344 27.9245C60.4324 27.5515 60.2314 27.0636 60.2314 26.5184C60.2314 25.9732 60.4324 25.4853 60.8344 25.1123C61.2363 24.7392 61.7531 24.5383 62.3561 24.5383C62.959 24.5383 63.4758 24.7105 63.8777 25.0836C64.2797 25.4566 64.4807 25.9158 64.4807 26.461C64.4807 27.0349 64.2797 27.5228 63.9064 27.9245C63.5045 28.3263 63.0164 28.5271 62.3561 28.5271V28.4984ZM60.6908 44.9989V30.8229H64.0213V44.9989H60.6908Z"
              fill="#363C3D" />
            <path
              d="M74.8736 45.1714C73.3806 45.1714 72.0599 44.8558 70.9115 44.2244C69.763 43.5931 68.8443 42.7322 68.1839 41.6417C67.5236 40.5513 67.2078 39.2886 67.2078 37.9112C67.2078 36.5338 67.5236 35.2424 68.1839 34.152C68.8443 33.0615 69.7343 32.2006 70.9115 31.598C72.0599 30.9953 73.3806 30.6797 74.8736 30.6797C76.2517 30.6797 77.4576 30.9667 78.5199 31.5119C79.5822 32.0571 80.3861 32.8893 80.9316 33.9798L78.3763 35.472C77.9457 34.812 77.4289 34.2954 76.8259 33.9798C76.223 33.6641 75.5626 33.4919 74.8449 33.4919C74.041 33.4919 73.2945 33.6641 72.6341 34.0372C71.9738 34.3815 71.457 34.8981 71.0837 35.5581C70.7105 36.2181 70.5382 37.0216 70.5382 37.9399C70.5382 38.8582 70.7105 39.6617 71.0837 40.3217C71.457 40.9817 71.9738 41.4983 72.6341 41.8426C73.2945 42.187 74.0123 42.3879 74.8449 42.3879C75.5626 42.3879 76.223 42.2157 76.8259 41.9C77.4289 41.5844 77.9457 41.0965 78.3763 40.4078L80.9316 41.9C80.3861 42.9618 79.5822 43.794 78.5199 44.3679C77.4576 44.9418 76.2517 45.2288 74.8736 45.2288V45.1714Z"
              fill="#363C3D" />
            <path
              d="M82.0798 33.4918V30.8517H91.5257V33.4918H82.0798ZM89.315 45.1712C87.7646 45.1712 86.5587 44.7695 85.6974 43.966C84.8648 43.1625 84.4341 41.9572 84.4341 40.4076V27.6951H87.7646V40.3215C87.7646 40.9815 87.9369 41.5268 88.2814 41.8998C88.6259 42.2729 89.114 42.4451 89.7169 42.4451C90.4634 42.4451 91.0664 42.2442 91.5832 41.8711L92.5019 44.2242C92.0999 44.5399 91.6406 44.7695 91.0664 44.9417C90.4921 45.1138 89.9179 45.1712 89.315 45.1712Z"
              fill="#363C3D" />
            <path
              d="M101.403 45.171C99.8234 45.171 98.4453 44.8553 97.2682 44.224C96.091 43.5927 95.1723 42.7318 94.5406 41.6413C93.8803 40.5508 93.5645 39.2882 93.5645 37.9108C93.5645 36.5333 93.8803 35.242 94.5119 34.1515C95.1435 33.0611 96.0049 32.2002 97.1246 31.5975C98.2443 30.9949 99.4789 30.6793 100.914 30.6793C102.35 30.6793 103.527 30.9662 104.618 31.5688C105.709 32.1715 106.542 33.0037 107.173 34.1228C107.805 35.2133 108.092 36.5046 108.092 37.9969C108.092 38.1403 108.092 38.3125 108.092 38.4847C108.092 38.6569 108.092 38.8291 108.063 39.0012H96.2633V36.7916H106.312L105.02 37.4803C105.02 36.6768 104.877 35.9594 104.503 35.3281C104.159 34.7255 103.671 34.2376 103.068 33.8646C102.465 33.4915 101.747 33.348 100.972 33.348C100.197 33.348 99.4502 33.5202 98.8473 33.8646C98.2443 34.2089 97.7562 34.6968 97.4117 35.3281C97.0672 35.9594 96.8949 36.7055 96.8949 37.5377V38.0829C96.8949 38.9438 97.0959 39.6899 97.4691 40.35C97.8711 41.01 98.4166 41.4978 99.1057 41.8709C99.8234 42.2152 100.627 42.3874 101.546 42.3874C102.35 42.3874 103.068 42.2726 103.699 42.0144C104.331 41.7561 104.905 41.383 105.393 40.8378L107.173 42.8753C106.542 43.6214 105.738 44.1953 104.762 44.597C103.786 44.9988 102.695 45.1997 101.46 45.1997L101.403 45.171ZM98.5889 28.9001L102.178 25.2556H106.082L101.46 28.9001H98.5889Z"
              fill="#363C3D" />
            <path
              d="M13.2071 29.8472H9.84795C4.42158 29.8472 0.0288086 25.4853 0.0288086 20.0617V11.5101C0.0288086 6.11517 4.42158 1.72461 9.81924 1.72461V4.88122C6.17295 4.88122 3.18701 7.86566 3.18701 11.5101V20.0617C3.18701 23.7061 6.17295 26.6906 9.81924 26.6906H13.1784C16.8247 26.6906 19.8106 23.7061 19.8106 20.0617V11.5101C19.8106 8.58307 17.9157 6.14387 15.8772 5.22558V23.5626H12.719V1.72461H14.2981C18.3751 1.72461 22.9688 5.9143 22.9688 11.5101V20.0617C22.9688 25.4566 18.5761 29.8472 13.1784 29.8472H13.2071Z"
              fill="#00A6C7" />
            <path
              d="M23.0836 32.5163V28.4414C20.3273 30.9667 16.7959 32.4015 13.0348 32.4015H9.27363C5.88574 32.4015 2.64141 31.225 0 29.1301V32.9755C2.78496 34.6398 6.00059 35.5581 9.27363 35.5581H9.93398V41.7279H0.861328V44.8845H21.4184V41.7279H13.0922V35.5581C16.7098 35.5581 20.1551 34.4964 23.0836 32.5163Z"
              fill="#00A6C7" />
          </g>
          <defs>
            <clipPath id="clip0_393_774">
              <rect width="147" height="44.9674" fill="white" transform="translate(0 0.232422)" />
            </clipPath>
          </defs>
        </svg>
      </div>
    </div>
    <button class="menu-button">
      <i class="fas fa-bars"></i>
    </button>
  </header>

  <!-- Tabs -->
  <div class="tabs">
    <button *ngFor="let tab of tabs" [class.active]="activeTab === tab" (click)="setActiveTab(tab)">
      {{ tab }}
    </button>
  </div>

  <!-- Note Cards -->
  <div class="notes-container">
    <div class="note-card" *ngFor="let note of getFilteredNotes()">
      <div class="note-header">
        <div class="patient-info">
          <img *ngIf="note.patientAvatar" [src]="note.patientAvatar" alt="Patient avatar" class="patient-avatar">
          <h3>{{ note.patient }}</h3>
        </div>
        <button class="menu-dots" (click)="toggleMenu(note.id)">
          <i class="fas fa-ellipsis-v"></i>
        </button>

        <!-- Dropdown Menu -->
        <div class="dropdown-menu" *ngIf="selectedNote === note.id">
          <button class="delete-btn" (click)="deleteNote(note.id)">
            <i class="fas fa-trash-alt"></i> Supprimer
          </button>
          <button class="edit-btn" (click)="editNote(note.id)">
            <i class="fas fa-edit"></i> Modifier
          </button>
        </div>
      </div>

      <p class="note-object">Objet: {{ note.object }}</p>

      <div class="audio-section">
        <div class="audio-header">
          <span>Audio:</span>
          <span class="duration">{{ note.audio.duration }}</span>
        </div>
        <div class="waveform">
          <div *ngFor="let value of note.audio.waveform; let i = index" class="waveform-bar" [class.active]="i < 10"
            [style.height.px]="4 + value * 12">
          </div>
        </div>
      </div>

      <p class="note-type">
        Note: <span class="ai-text">Générées par IA en Text</span>
      </p>

      <p class="date">Date de création: {{ note.creationDate }}</p>
      <p class="date" *ngIf="note.processedDate">Date de traitement: {{ note.processedDate }}</p>
      <p class="date" *ngIf="note.validationDate">Date de Validation: {{ note.validationDate }}</p>

      <div class="assignee" *ngIf="note.assignedTo">
        <img [src]="note.assignedTo.avatar" alt="Assignee avatar" class="assignee-avatar">
        <span>{{ note.assignedTo.name }}</span>
      </div>
      <p class="not-assigned" *ngIf="!note.assignedTo">Pas encore assigné</p>

      <!-- Download button for validated notes -->
      <button class="download-btn" *ngIf="note.status === 'validated'" (click)="downloadPdf(note.id)">
        Télécharger le pdf
      </button>
    </div>
  </div>

  <!-- Bottom Action Buttons -->
  <div class="action-buttons">
    <button class="action-btn write-btn">
      <i class="fas fa-pen"></i>
    </button>

    <!-- Remplacer le bouton d'enregistrement par notre composant VoiceRecorder -->
    <app-voice-recorder (recordingComplete)="onRecordingComplete($event)" (recordingCancelled)="onRecordingCancelled()">
    </app-voice-recorder>
  </div>
</div>